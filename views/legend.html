<div class="q-isotype-legend s-font-note {isHideLegend()}">
  {#each categories as category, index}
    {#if icons && icons[index] }
    <div class="q-isotype-legend-container">
      {#if icons[index].svg }
        <div class="q-isotype-legend-svg {isLowlight(index)}">
            <svg xmlns="http://www.w3.org/2000/svg">
              <symbol id="{ icons[index].key }">
                {@html icons[index].svg}
              </symbol>
              <svg>
                <use xlink:href="#{ icons[index].key }"></use>
              </svg>
            </svg>
        </div>
      {:else}
        <div class="q-isotype-legend-png {isLowlight(index)}" style="background-image: url('{ icons[index].url }')"></div>
      {/if}
      <div class="q-isotype-legend-category">{category}</div>
    </div>
    {:else}
    <div class="q-isotype-legend-container">
      <div class="q-isotype-legend-svg {isLowlight(index)}"><NoIconDefaultSVG /></div>
      <div class="q-isotype-legend-category">{category}</div>
    </div>
    {/if}
  {/each}
</div>

<script>
  import NoIconDefaultSVG from './no-icon-default-svg.html';

  export let icons;
  export let categories;
  export let options;

  function isHideLegend() {
    return options && options.hideLegend ? "q-isotype-hidden-legend" : null;
  }

  function isLowlight(index) {
    return options && options.highlightColumn !== null && options.highlightColumn !== undefined && options.highlightColumn !== index + 1 ? "q-isotype-lowlight" : null;
  }
</script>